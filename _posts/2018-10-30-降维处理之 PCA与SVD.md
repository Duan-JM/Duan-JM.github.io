---
layout: post
title: "降维处理之 PCA 与 SVD"
date: 2018-10-30
categories: MathTools
tags: ["NLP" , "MachineLearning", "MathTools"]
---
# 降维处理
## PCA
### 简要说明
PCA 的全称为**主成分分析**（Principal Component Analysis）。简单的来说，PCA 的目的是将原来的坐标系旋转为新的坐标系，新的坐标系的选择是由数据本身决定的。第一个坐标系的选择是原始数据中方差最大的方向，第二个是和第一个坐标系正交（orthogonal）且方差最大的坐标轴，第三个，第四个均重复上述操作，重复次数为原始数据中特征的数目[^1]。

### 实现手法
实际上我们是通过协方差矩阵[^2]及其特征分析来求这些主成分的值的。其中特征分析就是指的是求他们的特征向量和特征值。
> 协方差能导出一个[变换矩阵](https://zh.wikipedia.org/wiki/%E5%8F%98%E6%8D%A2%E7%9F%A9%E9%98%B5 "变换矩阵")，这个矩阵能使数据完全去相关(decorrelation)。从不同的角度看，也就是说能够找出一组最佳的基以紧凑的方式来表达数据。(完整的证明请参考[瑞利商](https://zh.wikipedia.org/w/index.php?title=%E7%91%9E%E5%88%A9%E5%95%86&action=edit&redlink=1 "瑞利商（页面不存在）"))。 这个方法在统计学中被称为[主成分分析](https://zh.wikipedia.org/wiki/%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90 "主成分分析")(principal components analysis)，在图像处理中称为Karhunen-Loève 变换(KL-变换)。
> ——— Wiki

具体实现的伪代码如下：
```python
# 去除平均值 （使用numpy中的mean）
# 计算协方差矩阵 （使用numpy中的cov函数，根据定义构建）
# 计算协方差矩阵的特征值和特征向量（使用numpy中的eig()函数返回特征值和特征向量）
# 将特征值从大到小排序（使用numpy中的argsort(),得到最大的特征值对应的特征向量的位置）
# 保留最大的N个特征向量
# 将数据转换到上述N个特征向量构建的新空间
```

## SVD
### 简述
SVD（Singular Value Decomposition），即奇异值分解，本质上是一种矩阵分解技术，在应用领域已经出现了进百年。矩阵分解技术指的是将一个原始矩阵表示成新的易于处理的形式，这种形式是两个或多个矩阵的乘积，可以简单的理解为因式分解。最早使用 SVD 的应用的领域为信息检索，使用 SVD 的检索方法称为隐性语义索引（Latent Semantic Index，**LSI**）或隐性语义分析（Latent Semantic Analysis，**LSA**）。

### 细节说明
SVD 将原始的数据集矩阵  $Data$  分解成三个矩阵  $U$、 $\Sigma$ 、 $V^T$。若原始矩阵是  $m*n$ 矩阵，那么 $U$ 为 $m*m$， $\Sigma$ 为 $m*n$， $V^T$ 为 $n*n$，写成公式如下[^3]：

$$
Data_{m*n} = U_{m*m}\Sigma_{m*n}V^T_{n*n} 
$$

其中 $\sum$ 为对角矩阵，这些对角上的值为**奇异值**，这个奇异值和特征值是有关系的，它是矩阵  $Data*Data^T$ 的特征值的平方根。

实现方式已经很成熟啦，使用numpy的库就好啦，函数如下：
```python
from numpy import *
U,Sigma,VT = linalg.svd(Matrix)    
```
*注：详细实现过程参考《Numerical Linear Algebra》[^4]*

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath:[['$','$']]}});</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

[^1]:	《机器学习实战》 P243

[^2]:	https://zh.wikipedia.org/wiki/协方差矩阵

[^3]:	《机器学习实战》 P254

[^4]:	L.Trefethen and D.Bau III, Numerical Linear Algebra(SIAM: Society for Industrial and Applied Mathematics, 1997)