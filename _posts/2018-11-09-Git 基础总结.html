---
layout: post
title: "Git 操作总结"
date: 2018-11-09
categories: 软件使用
tags: ['Github','代码管理','教程']
---
<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<title>Git 操作总结</title>
	</head>
<body>
<h2>基础操作</h2>
<ul>
	<li><code>git init</code>：将文件目录转为 git 仓库</li>
	<li><code>git add &lt;filename&gt;</code>：将文件存入暂存区</li>
	<li><code>git push</code>：将修改同步到远端仓库</li>
	<li><code>git pull</code>：将远端仓库的新修改同步到本地</li>
	<li><code>git diff &lt;filename&gt;</code>：查看工作区的修改了哪些内容，没有 <code>add</code> 的文件是不在 <code>diff</code> 的作用范围的。</li>
	<li><code>git commit -m &lt;msg&gt;</code>：将暂存区的内容提交到仓库，<code>commit</code> 后会得到干净工作区。</li>
	<li><code>git status</code>：查看工作区的状态</li>
	<li><code>git log [--graph]</code>：查看记录</li>
	<li><code>git tag</code>：查看标签</li>
</ul>

<h2>Git 结构说明</h2>
<ol>
	<li>工作区

		<p>工作区可以理解为咱们存放自己代码的文件目录。</p></li>
	<li>版本库

		<p>工作区中含有一个隐藏的目录 <code>.git</code> ， 这个就是 Git 的版本哭。里面有很多东西，我们的 Git 中的很多历史信息都是存在这里，版本回溯也是靠着里面的信息做到的。</p></li>
	<li>暂存区

		<p>暂存区，可以理解为我们从工作区将代码移入“分支”前的中转站，在这里我们可以进行一些检查工作。</p></li>
</ol>

<h2>忽略特殊文件</h2>

<p>Mac 下有 <code>.DS_Store</code>，运行 python 有 <code>.pyc</code>文件，make 有很多中间生成的文件，这些都是我们不想上传到仓库的文件，<code>.gitignore</code> 就是让我们配置哪些文件不用上传的位置。</p>

<ol>
	<li>配置方式

		<p>其实就是将不想上传的文件放在里面就好了，可以使用一些正则语法如<code>*</code>，<code>[]</code>等等。同时 Github 为我们准备了一些常用的忽略列表可以直接使用。</p>

<pre><code class="code-highlighted code-bash"><span class="syntax-all syntax-comment"># Mac
</span>.DS_Store
<span class="syntax-all syntax-comment"># Python
</span><span class="syntax-all syntax-keyword">*</span>.py[cod]</code></pre></li>
	<li>强制添加文件

		<p><code>git add -f &lt;file_name&gt;</code>：强制添加忽略规则内的文件。</p></li>
	<li>查看文件为什么没有添加

		<p><code>git check-ignore -v &lt;file_name&gt;</code>：会输出到底是哪个规则忽略了这个文件。</p></li>
</ol>

<h2>版本回退</h2>

<ul>
	<li><code>git log/reflog</code>：查看当前位置<strong>之前/之后</strong>的 commit</li>
	<li><code>git reset --hard HEAD^/&lt;commitID&gt;</code>：回退到<strong>上一步 / 某一个 commit </strong>的状态</li>
	<li><code>git checkout -- &lt;filename&gt;</code>：退回到 <code>commit</code> 或 <code>add</code> 时的状态。<strong>这个指令也可以恢复删掉的文件</strong>。

		<p><em>注：如果没有 <code>--</code> 就成了切换分支指令了</em></p></li>
	<li><code>git reset HEAD &lt;filename&gt;</code>：回退到提交之前最新的状态</li>
</ul>

<h2>标签管理</h2>

<ul>
	<li><code>git tag &lt;tag_name&gt;</code>：打开一个标签</li>
	<li><code>git tag</code>：查看所有标签</li>
	<li><code>git tag -a &lt;tag_name&gt; -m &lt;description&gt; &lt;commit_id&gt;</code>：tag 是针对 commit 的，也就是说这次 commit 出现的分支上都可以看到这个标签。</li>
	<li><code>git show &lt;tag_name&gt;</code>：查看 tag 的详细信息。</li>
	<li><code>git push origin &lt;tag_name&gt;</code>：将 tag 推送到远程服务器，<strong>tag 不会自动推送到远程</strong>。</li>
	<li><code>git tag -d &lt;tag_name&gt;</code>：本地删除 tag</li>
	<li><code>git push origin :refs/tags/&lt;tag_name&gt;</code>：本地删除后，让远程仓库端也删除标签</li>
</ul>

<h2>远程仓库</h2>

<p>首先要注意的是，<strong>远程仓库和本地的仓库是不同的仓库</strong>，这个概念在心里要有。</p>

<ul>
	<li><code>git remote -v</code>：查看有哪些远程仓库，<code>-v</code> 是更加详细显示。</li>
	<li><code>git remote add &lt;name&gt; &lt;git_url&gt;</code>：同远程仓库关联，一般 <code>name</code> 为 <code>origin</code>。</li>
	<li><code>git push -u origin master</code>：第一次提交会将本地<code>master</code> 分支和远程的 <code>master</code> 分支关联起来。</li>
	<li><code>git branch --set-upstream-to=origin/&lt;branch_name&gt; &lt;local_branch_name&gt;</code>：当不能从远程仓库 <code>pull</code> 的时候，根据提示设置本地分支和远程分支的链接。</li>
	<li><code>git rebase</code>：正常 <code>merge</code> 后，<code>git log --graph</code> 展现的会出现分叉，有的人觉得这样子对比不直观，不想有这些分叉，于是就出现了这个 <code>rebase</code>。</li>
</ul>

<h2>分支管理</h2>

<p>这里要注意的是，我们对 git 仓库的操作可以想象是我们操作的是在<strong>操作一个链表上的指针</strong>。</p>

<ul>
	<li><code>git branch -a</code>：查看当前仓库有什么分支。</li>
	<li><code>git checkout -b &lt;new_branch_name&gt;</code>：新建一个分支，相当于 <code>git branch &lt;new_branch_name&gt;</code> 之后再 <code>git checkout &lt;new_branch_name&gt;</code>。</li>
	<li><code>git merge [--no-ff -m &quot;msg&quot;] &lt;branch_name&gt;</code>：将别的分支合并到当前分支。默认时 <code>Fast forward</code> 模式，也就是说这种模式下删除分支后会丢掉分支信息，<code>--no-ff</code> 取消了<code>Fast forward</code>。</li>
	<li><code>git branch -d/D &lt;branch_name&gt;</code>：删除/强制删除某个分支</li>
</ul>

<h2>Git 开发分支思路</h2>

<ul>
	<li><code>master</code>：应该非常稳定，仅用来发布新版本，平时不在上面进行操作，<strong>需要关联到远程仓库</strong>。</li>
	<li><code>dev</code>：这个是真正干活的地方，大家维护自己的分支，之后合并到 dev 上，<strong>需要关联到远程仓库</strong>。</li>
	<li><code>bug</code>：bug 修复分支，如果没有合作开发就不关联到远程仓库。</li>
	<li><code>Feature</code>：新的功能开发，如果没有合作开发就不关联到远程仓库</li>
</ul>

<h2>Github 的其他使用说明</h2>

<ol>
	<li>合作开发：一般而言，我们不具有别人仓库的修改权限，所以我们要是想参与开源项目的话，需要有以下几个步骤：

		<ul>
			<li><code>Fork</code> 别人的仓库：这时候我们就有一个能修改的仓库了。</li>
			<li><code>pull request</code>：当你修改了一个 bug 或者开发了一个新 feature 以后，可以通过<code>pull request</code> 告知仓库所有者，看对方是否接受你的 <code>pull request</code>。</li>
		</ul></li>
	<li>别名

		<p>有些指令很长，我们不希望每次都要手动输入，解决这个问题的方式就是使用别名。当然这种别名设置在 <code>zshrc</code> 中也可以。</p>

		<ol>
			<li>在 <code>.gitconfig</code> 文件中的 <code>[alias]</code> 下设置

<pre><code class="code-highlighted code-bash"><span class="syntax-all syntax-comment"># in ~/.gitconfig
</span>[alias]
  lg = log --color --graph --pretty=format:<span class="syntax-all syntax-string">&#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%ci) %C(bold blue) &lt;%an&gt;%Creset&#39;</span> --abbrev-commit</code></pre></li>
			<li>直接使用命令行

				<p>使用 <code>git config --global alias.&lt;alias_cmd&gt; &lt;cmd&gt;</code> 来设置别名</p>

<pre><code class="code-highlighted code-bash">git config --global alias.ci commit</code></pre></li>
		</ol></li>
	<li>搭建 Git 服务器

		<p>除了使用 Github 官方的服务器外，我们还可以自己搭建自己的 Git 服务器，搭建的方法教程链接为<a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/00137583770360579bc4b458f044ce7afed3df579123eca000">这里</a>。</p></li>
</ol>

<h2>参考资料</h2>

<ul>
	<li><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000">廖雪峰 Git 教程</a></li>
</ul>

</body>
</html>

